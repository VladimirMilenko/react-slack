"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}var t=require("lodash"),n=require("events"),i=e(require("react-reconciler")),r=e(require("uuid/v4"));function o(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}var c=function(){function e(e,t,n){this.props=e,this.__root=t,this.__type=n}return e.prototype.onCommit=function(){this.__root.onCommited()},e}(),s=function(e){function t(t,n){var i;return(i=e.call(this,t,n,"ACTIONS")||this).elements=[],i}o(t,e);var n=t.prototype;return n.appendChild=function(e){this.elements.push(e)},n.removeChild=function(e){var t=this.elements.indexOf(e);this.elements.splice(t,1)},n.insertBefore=function(e,t){var n=this.elements.indexOf(t);0===n?this.elements.unshift(e):this.elements.splice(n-1,0,e)},n.render=function(){return{type:"actions",elements:this.elements.map((function(e){return e.render()}))}},t}(c),u=function(e){function t(t,n){var i;return(i=e.call(this,{},n,"TEXT")||this).text=t,i}o(t,e);var n=t.prototype;return n.setText=function(e){this.text=e},n.render=function(){return{type:"plain_text",text:this.text}},t}(c),l=function(e){function t(t,n){var i;return(i=e.call(this,t,n,"BUTTON")||this).children=[],i.style=t.style,i.value=t.value,i.onClick=t.onClick,i}o(t,e);var n=t.prototype;return n.appendChild=function(e){"TEXT"===e.__type&&this.children.push(e)},n.removeChild=function(e){var t=this.children.indexOf(e);this.children.splice(t,1)},n.setActionId=function(e){this.__actionId=e},n.insertBefore=function(e,t){var n=this.children.indexOf(t);0===n?this.children.unshift(e):this.children.splice(n-1,0,e)},n.render=function(){var e=this.style,t=this.value;return{type:"button",text:new u(this.children.map((function(e){return e.text})).join(""),{onCommited:function(){}}).render(),action_id:this.__actionId,value:t,style:e}},t}(c),d=function(e){function t(t,n){var i;return(i=e.call(this,t,n,"MARKDOWN")||this).children=[],i}o(t,e);var n=t.prototype;return n.appendChild=function(e){this.children.push(e)},n.removeChild=function(e){var t=this.children.indexOf(e);this.children.splice(t,1)},n.insertBefore=function(e,t){var n=this.children.indexOf(t);0===n?this.children.unshift(e):this.children.splice(n-1,0,e)},n.render=function(){return{type:"mrkdwn",text:this.children.map((function(e){return e.text})).join("")}},t}(c),h=function(e){function t(t,n){var i;return(i=e.call(this,t,n,"CONTEXT")||this).elements=[],i}o(t,e);var n=t.prototype;return n.appendChild=function(e){this.elements.push(e)},n.removeChild=function(e){var t=this.elements.indexOf(e);this.elements.splice(t,1)},n.insertBefore=function(e,t){var n=this.elements.indexOf(t);0===n?this.elements.unshift(e):this.elements.splice(n-1,0,e)},n.render=function(){return{type:"context",elements:this.elements.map((function(e){return e instanceof d?e.render():"TEXT"===e.__type?new u(e.text,{onCommited:function(){}}).render():null}))}},t}(c),a=function(e){function t(t,n){var i;return(i=e.call(this,t,n,"DATEPICKER")||this).onChange=t.onChange,i.value=t.value||void 0,i.placeholder=t.placeholder,i.initialDate=t.initialDate||void 0,i.__actionId=t.actionId,i}o(t,e);var n=t.prototype;return n.setActionId=function(e){this.__actionId=e},n.render=function(){var e=this.value,t=this.placeholder,n=this.initialDate,i=this.__actionId;return{type:"datepicker",placeholder:t?new u(t,{onCommited:function(){}}).render():void 0,action_id:i,initial_date:e||n||void 0}},t}(c),f=function(e){function t(t,n){var i;return(i=e.call(this,t,n,"DIVIDER")||this).children=[],i}o(t,e);var n=t.prototype;return n.appendChild=function(){},n.removeChild=function(){},n.render=function(){return{type:"divider"}},t}(c),p=function(e){function t(t,n){var i;return(i=e.call(this,t,n,"SECTION")||this).fields=null,i.accessory=null,i.text=null,i.fields=null,i.accessory=null,i.text=null,i}o(t,e);var n=t.prototype;return n.appendChild=function(e){if(e instanceof _)this.text=e;else if(e instanceof C)this.fields=e;else{if(!(e instanceof m))throw new Error("Usupported type");this.accessory=e}},n.removeChild=function(e){if(e instanceof _)this.text=null;else if(e instanceof C)this.fields=null;else{if(!(e instanceof m))throw new Error("Usupported type");this.accessory=null}},n.insertBefore=function(e){this.appendChild(e)},n.render=function(){return{type:"section",text:this.text?this.text.render():void 0,fields:this.fields?this.fields.render():void 0,accessory:this.accessory?this.accessory.render():void 0}},t}(c),_=function(e){function t(t,n){var i;return(i=e.call(this,t,n,"SECTION_TEXT")||this).children=[],i.render=function(){return{type:i.children.some((function(e){return"MARKDOWN"===e.__type}))?"mrkdwn":"plain_text",text:i.children.map((function(e){return e.render()})).map((function(e){return e.text})).join("")}},i.children=[],i}o(t,e);var n=t.prototype;return n.appendChild=function(e){this.children.push(e)},n.removeChild=function(e){var t=this.children.indexOf(e);this.children.splice(t,1)},n.insertBefore=function(e,t){var n=this.children.indexOf(t);0===n?this.children.unshift(e):this.children.splice(n-1,0,e)},t}(c),C=function(e){function t(t,n){var i;return(i=e.call(this,t,n,"SECTION_FIELDS")||this).children=[],i.render=function(){return i.children.map((function(e){return e.render()}))},i.children=[],i}o(t,e);var n=t.prototype;return n.appendChild=function(e){this.children.push(e)},n.removeChild=function(e){var t=this.children.indexOf(e);this.children.splice(t,1)},n.insertBefore=function(e,t){var n=this.children.indexOf(t);0===n?this.children.unshift(e):this.children.splice(n-1,0,e)},t}(c),m=function(e){function t(t,n){var i;return(i=e.call(this,t,n,"SECTION_ACCESSORY")||this).children=[],i.render=function(){if(i.children.length>1)throw new Error("Accessory only accepts one child");return i.children&&0!==i.children.length?i.children[0].render():null},i.children=[],i}o(t,e);var n=t.prototype;return n.appendChild=function(e){this.children.push(e)},n.removeChild=function(e){var t=this.children.indexOf(e);this.children.splice(t,1)},n.insertBefore=function(e,t){var n=this.children.indexOf(t);0===n?this.children.unshift(e):this.children.splice(n-1,0,e)},t}(c),v=i({getRootHostContext:function(e){return{root:e}},getChildHostContext:function(e,t,n){return{}},getPublicInstance:function(e){return{}},prepareForCommit:function(e){},resetAfterCommit:function(e){},createInstance:function(e,t,n,i,r){return function(e,t,n){var i={BUTTON:function(){return new l(t,n)},ACTIONS:function(){return new s(t,n)},CONTEXT:function(){return new h(t,n)},MARKDOWN:function(){return new d(t,n)},DIVIDER:function(){return new f(t,n)},SECTION:function(){return new p(t,n)},SECTION_TEXT:function(){return new _(t,n)},SECTION_FIELDS:function(){return new C(t,n)},SECTION_ACCESSORY:function(){return new m(t,n)},DATEPICKER:function(){return new a(t,n)}};if("function"==typeof i[e])return i[e]();throw new Error("Unsupported element type")}(e,t,n)},createTextInstance:function(e,t,n,i){return new u(e,t)},appendInitialChild:function(e,t){e.appendChild(t)},finalizeInitialChildren:function(e,t,n,i,o){switch(t){case"BUTTON":return void(n.onClick&&(e.__root&&e.__root.handlerRegistry&&e.__actionId&&(delete e.__root.handlerRegistry[e.__actionId],e.__root.unsubscribeFromAction(e.__actionId)),e.__actionId=r(),e.onClick=n.onClick,e.__root.handlerRegistry[e.__actionId]=e.onClick,e.__root&&e.__root.subscribeToNewActionId(e.__actionId)));case"DATEPICKER":return void(n.onChange&&(e.__root&&e.__root.handlerRegistry&&e.__actionId&&(delete e.__root.handlerRegistry[e.__actionId],e.__root.unsubscribeFromAction(e.__actionId)),e.__actionId=r(),e.onChange=n.onChange,e.__root.handlerRegistry[e.__actionId]=e.onChange,e.__root&&e.__root.subscribeToNewActionId(e.__actionId)));default:return}},prepareUpdate:function(e,t,n,i,r,o){var c=[],s=new Set(Object.keys(i).concat(Object.keys(n))).values(),u=Array.isArray(s),l=0;for(s=u?s:s[Symbol.iterator]();;){var d,h;if(u){if(l>=s.length)break;d=s[l++]}else{if((l=s.next()).done)break;d=l.value}"children"!==d&&n[d]!==i[d]&&c.push(((h={})[d]=i[d],h))}return c},shouldSetTextContent:function(e,t){return!1},shouldDeprioritizeSubtree:function(e,t){console.log("shouldDeprioritizeSubtree")},now:Date.now,isPrimaryRenderer:!0,scheduleDeferredCallback:"",cancelDeferredCallback:"",supportsMutation:!0,commitMount:function(){},commitUpdate:function(e,t,n){switch(n){case"BUTTON":t.forEach((function(t){Object.keys(t).forEach((function(n){"onClick"===n?(e.__root&&e.__root.handlerRegistry&&(delete e.__root.handlerRegistry[e.__actionId],e.__root.unsubscribeFromAction(e.__actionId)),e.__actionId=r(),e.onClick=t[n],e.__root.handlerRegistry[e.__actionId]=e.onClick,e.__root&&e.__root.subscribeToNewActionId(e.__actionId)):e[n]=t[n]}))}));break;case"DATEPICKER":t.forEach((function(t){Object.keys(t).forEach((function(n){"onChange"===n?(e.__root&&e.__root.handlerRegistry&&(delete e.__root.handlerRegistry[e.__actionId],e.__root.unsubscribeFromAction(e.__actionId)),e.__actionId=r(),e.onChange=t[n],e.__root.handlerRegistry[e.__actionId]=e.onChange,e.__root&&e.__root.subscribeToNewActionId(e.__actionId)):e[n]=t[n]}))}));break;default:t.forEach((function(t){e[key]=t[key]}))}setTimeout((function(){e.onCommit()}),0)},resetTextContent:function(){throw new Error("Not implemented")},commitTextUpdate:function(e,t,n){e.setText(n),setTimeout((function(){e.onCommit()}),0)},appendChild:function(e,t){e.appendChild(t)},appendChildToContainer:function(e,t){e.appendChild(t)},insertBefore:function(){},insertInContainerBefore:function(e,t,n){e.insertBefore(t,n)},removeChild:function(e,t){e.removeChild(t)},removeChildFromContainer:function(e,t){e.removeChild(t)}}),y={render:function(e,t){var n=v.createContainer(t,!1,!1);return v.updateContainer(e,n,null,null),t}};exports.Actions="ACTIONS",exports.Button="BUTTON",exports.Context="CONTEXT",exports.DatePicker="DATEPICKER",exports.Divider="DIVIDER",exports.Markdown="MARKDOWN",exports.ObjectSlackContainer=function(){var e=this;this.unsubscribeFromAction=function(){},this.subscribeToNewActionId=function(){},this.appendChild=function(t){e.blocks.push(t)},this.removeChild=function(t){var n=e.blocks.indexOf(t);e.blocks.splice(n,1)},this.insertBefore=function(t,n){var i=e.blocks.indexOf(n);e.blocks.splice(i,0,t)},this.onCommited=function(){},this.render=function(){return e.blocks.map((function(e){return e.render()}))},this.blocks=[],this.lastCommited=null},exports.RedisSlackContainer=function(e,i){var r=this;this.unsubscribeFromAction=function(e){r.subClient.unsubscribe(e)},this.subscribeToNewActionId=function(e){r.subClient.subscribe(e)},this.appendChild=function(e){r.blocks.push(e),setTimeout(r.onCommited,0)},this.removeChild=function(e){var t=r.blocks.indexOf(e);r.blocks.splice(t,1),setTimeout(r.onCommited,0)},this.insertBefore=function(e,t){var n=r.blocks.indexOf(t);r.blocks.splice(n,0,e),setTimeout(r.onCommited,0)},this.onCommited=function(){var e=r.render();t.isEqual(r.lastCommited,e)||(r.emitter.emit("commit",e),r.lastCommited=e)},this.render=function(){return r.blocks.map((function(e){return e.render()}))},this.handlerRegistry=i,this.subClient=e,this.blocks=[],this.emitter=new n.EventEmitter,this.subClient.on("message",(function(e,t){if(r.handlerRegistry[e]){var n=JSON.parse(t);r.handlerRegistry[e](n)}})),this.lastCommited=null},exports.Section="SECTION",exports.SectionAccessory="SECTION_ACCESSORY",exports.SectionFields="SECTION_FIELDS",exports.SectionText="SECTION_TEXT",exports.SlackDOM=y;
//# sourceMappingURL=host.cjs.production.min.js.map
