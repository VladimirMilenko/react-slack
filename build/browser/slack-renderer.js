function t(t){return t&&"object"==typeof t&&"default"in t?t.default:t}require("react");var e=t(require("lodash")),n=t(require("react-reconciler")),i=t(require("uuid/v4")),r={SlackContainer:function(t,n,i,r){var o=this;this.unsubscribeFromAction=function(t){o.stateful&&o.subClient.unsubscribe(t)},this.subscribeToNewActionId=function(t){o.stateful&&o.subClient.subscribe(t)},this.appendChild=function(t){o.blocks.push(t),setImmediate(o.onCommited,0)},this.removeChild=function(t){var e=o.blocks.indexOf(t);o.blocks.splice(e,1),setImmediate(o.onCommited,0)},this.insertBefore=function(t,e){var n=o.blocks.indexOf(e);o.blocks.splice(n,0,t),setImmediate(o.onCommited,0)},this.onCommited=function(){var t=o.render();e.isEqual(o.lastCommited,t)||(o.stateful&&o.emitter.emit("commit",t),o.lastCommited=t)},this.render=function(){return o.blocks.map(function(t){return t.render()})},this.handlerRegistry=n,this.subClient=t,this.stateful=r,this.blocks=[],this.stateful&&(this.emitter=new EventEmitter,this.response_url=i,this.subClient.on("message",function(t,e){if(o.handlerRegistry[t]){var n=JSON.parse(e);o.response_url=n.response_url,o.handlerRegistry[t](n)}}),this.lastCommited=null)}},o=function(t,e,n){this.props=t,this.__root=e,this.__type=n};o.prototype.onCommit=function(){this.__root.onCommited()};var c=function(t){function e(e,n){t.call(this,e,n,"ACTIONS"),this.elements=[]}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.appendChild=function(t){this.elements.push(t)},e.prototype.removeChild=function(t){var e=this.elements.indexOf(t);this.elements.splice(e,1)},e.prototype.insertBefore=function(t,e){var n=this.elements.indexOf(e);0===n?this.elements.unshift(t):this.elements.splice(n-1,0,t)},e.prototype.render=function(){return{type:"actions",elements:this.elements.map(function(t){return t.render()})}},e}(o),s=function(t){function e(e,n){t.call(this,null,n,"TEXT"),this.text=e}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.setText=function(t){this.text=t},e.prototype.render=function(){return{type:"plain_text",text:this.text}},e}(o),u=function(t){function e(e,n){t.call(this,e,n,"BUTTON"),this.children=[],this.onClick=e.onClick}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.appendChild=function(t){"TEXT"===t.__type&&this.children.push(t)},e.prototype.removeChild=function(t){var e=this.children.indexOf(t);this.children.splice(e,1)},e.prototype.insertBefore=function(t,e){var n=this.children.indexOf(e);0===n?this.children.unshift(t):this.children.splice(n-1,0,t)},e.prototype.render=function(){var t=this.style,e=this.value,n=this.confirm;return{type:"button",text:new s(this.children.map(function(t){return t.text}).join("")).render(),action_id:this.__actionId,value:e,style:t,confirm:n}},e}(o),l=function(t){function e(e,n){t.call(this,e,n,"MARKDOWN"),this.children=[]}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.appendChild=function(t){this.children.push(t)},e.prototype.removeChild=function(t){var e=this.children.indexOf(t);this.children.splice(e,1)},e.prototype.insertBefore=function(t,e){var n=this.children.indexOf(e);0===n?this.children.unshift(t):this.children.splice(n-1,0,t)},e.prototype.render=function(){return{type:"mrkdwn",text:this.children.map(function(t){return t.text}).join("")}},e}(o),h=function(t){function e(e,n){t.call(this,e,n,"CONTEXT"),this.elements=[]}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.appendChild=function(t){this.elements.push(t)},e.prototype.removeChild=function(t){var e=this.elements.indexOf(t);this.elements.splice(e,1)},e.prototype.insertBefore=function(t,e){var n=this.elements.indexOf(e);0===n?this.elements.unshift(t):this.elements.splice(n-1,0,t)},e.prototype.render=function(){return{type:"context",elements:this.elements.map(function(t){return t instanceof l?t.render():"TEXT"===t.__type?new s(t.text).render():void 0})}},e}(o),d=function(t){function e(e,n){t.call(this,e,n,"DATEPICKER"),this.onChange=null,this.value=e.value||void 0,this.placeholder=e.placeholder,this.initialDate=e.initialDate||void 0}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.render=function(){var t=this.value,e=this.initialDate;return{type:"datepicker",placeholder:this.placeholder?new s(this.placeholder).render():void 0,action_id:this.__actionId,initial_date:t||e||void 0}},e}(o),p=function(t){function e(e,n){t.call(this,e,n,"DIVIDER"),this.children=[]}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.appendChild=function(t){},e.prototype.removeChild=function(t){},e.prototype.render=function(){return{type:"divider"}},e}(o),a=function(t){function e(e,n){t.call(this,e,n,"SECTION"),this.fields=null,this.accessory=null,this.text=null}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.appendChild=function(t){switch(t.__type){case"SECTION_TEXT":this.text=t;break;case"SECTION_FIELDS":this.fields=t;break;case"SECTION_ACCESSORY":this.accessory=t;break;default:this.fields.push(t)}},e.prototype.removeChild=function(t){switch(t.__type){case"SECTION_TEXT":this.text=null;break;case"SECTION_FIELDS":this.fields=null;break;case"SECTION_ACCESSORY":this.accessory=null;break;default:var e=this.children.indexOf(t);this.fields.splice(e,1)}},e.prototype.insertBefore=function(t,e){this.appendChild(t)},e.prototype.render=function(){return{type:"section",text:this.text?this.text.render():void 0,fields:this.fields?this.fields.render():void 0,accessory:this.accessory?this.accessory.render():void 0}},e}(o),f=function(t){function e(e,n){var i=this;t.call(this,e,n,"SECTION_TEXT"),this.render=function(){return{type:i.children.some(function(t){return"MARKDOWN"===t.__type})?"mrkdwn":"plain_text",text:i.children.map(function(t){return t.render()}).map(function(t){return t.text}).join("")}},this.children=[]}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.appendChild=function(t){this.children.push(t)},e.prototype.removeChild=function(t){var e=this.children.indexOf(t);this.children.splice(e,1)},e.prototype.insertBefore=function(t,e){var n=this.children.indexOf(e);0===n?this.children.unshift(t):this.children.splice(n-1,0,t)},e}(o),_=function(t){function e(e,n){var i=this;t.call(this,e,n,"SECTION_FIELDS"),this.render=function(){return i.children.map(function(t){return t.render()})},this.children=[]}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.appendChild=function(t){this.children.push(t)},e.prototype.removeChild=function(t){var e=this.children.indexOf(t);this.children.splice(e,1)},e.prototype.insertBefore=function(t,e){var n=this.children.indexOf(e);0===n?this.children.unshift(t):this.children.splice(n-1,0,t)},e}(o),C=function(t){function e(e,n){var i=this;t.call(this,e,n,"SECTION_ACCESSORY"),this.render=function(){if(i.children.length>1)throw new Error("Accessory only accepts one child");return i.children&&0!==i.children.length?i.children[0].render():null},this.children=[]}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.appendChild=function(t){this.children.push(t)},e.prototype.removeChild=function(t){var e=this.children.indexOf(t);this.children.splice(e,1)},e.prototype.insertBefore=function(t,e){var n=this.children.indexOf(e);0===n?this.children.unshift(t):this.children.splice(n-1,0,t)},e}(o),m=n({getRootHostContext:function(t){return{root:t}},getChildHostContext:function(t,e,n){return{}},getPublicInstance:function(t){return{}},prepareForCommit:function(t){},resetAfterCommit:function(t){},createInstance:function(t,e,n,i,r){return function(t,e,n){return{BUTTON:function(){return new u(e,n)},ACTIONS:function(){return new c(e,n)},CONTEXT:function(){return new h(e,n)},MARKDOWN:function(){return new l(e,n)},DIVIDER:function(){return new p(e,n)},SECTION:function(){return new a(e,n)},SECTION_TEXT:function(){return new f(e,n)},SECTION_FIELDS:function(){return new _(e,n)},SECTION_ACCESSORY:function(){return new C(e,n)},DATEPICKER:function(){return new d(e,n)}}[t]()}(t,e,n)},createTextInstance:function(t,e,n,i){return new s(t,e)},appendInitialChild:function(t,e){t.appendChild(e)},finalizeInitialChildren:function(t,e,n,r,o){switch(e){case"BUTTON":return void(n.onClick&&(t.__root&&t.__root.handlerRegistry&&t.__actionId&&(delete t.__root.handlerRegistry[t.__actionId],t.__root.unsubscribeFromAction(t.__actionId)),t.__actionId=i(),t.onClick=n.onClick,t.__root.handlerRegistry[t.__actionId]=t.onClick,t.__root&&t.__root.subscribeToNewActionId(t.__actionId)));case"DATEPICKER":return void(n.onChange&&(t.__root&&t.__root.handlerRegistry&&t.__actionId&&(delete t.__root.handlerRegistry[t.__actionId],t.__root.unsubscribeFromAction(t.__actionId)),t.__actionId=i(),t.onChange=n.onChange,t.__root.handlerRegistry[t.__actionId]=t.onChange,t.__root&&t.__root.subscribeToNewActionId(t.__actionId)));default:return}return!1},prepareUpdate:function(t,e,n,i,r,o){for(var c,s=[],u=0,l=new Set(Object.keys(i).concat(Object.keys(n))).values();u<l.length;u+=1){var h=l[u];"children"!==h&&n[h]!==i[h]&&s.push(((c={})[h]=i[h],c))}return s},shouldSetTextContent:function(t,e){return!1},shouldDeprioritizeSubtree:function(t,e){console.log("shouldDeprioritizeSubtree")},now:Date.now,isPrimaryRenderer:!0,scheduleDeferredCallback:"",cancelDeferredCallback:"",supportsMutation:!0,commitMount:function(t,e,n,i){},commitUpdate:function(t,e,n,r,o,c){switch(n){case"BUTTON":e.forEach(function(e){Object.keys(e).forEach(function(n){"onClick"===n?(t.__root&&t.__root.handlerRegistry&&(delete t.__root.handlerRegistry[t.__actionId],t.__root.unsubscribeFromAction(t.__actionId)),t.__actionId=i(),t.onClick=e[n],t.__root.handlerRegistry[t.__actionId]=t.onClick,t.__root&&t.__root.subscribeToNewActionId(t.__actionId)):t[n]=e[n]})});break;case"DATEPICKER":e.forEach(function(e){Object.keys(e).forEach(function(n){"onChange"===n?(t.__root&&t.__root.handlerRegistry&&(delete t.__root.handlerRegistry[t.__actionId],t.__root.unsubscribeFromAction(t.__actionId)),t.__actionId=i(),t.onChange=e[n],t.__root.handlerRegistry[t.__actionId]=t.onChange,t.__root&&t.__root.subscribeToNewActionId(t.__actionId)):t[n]=e[n]})});break;default:e.forEach(function(e){t[key]=e[key]})}setImmediate(function(){t.onCommit()},0)},resetTextContent:function(t){throw new Error("Not implemented")},commitTextUpdate:function(t,e,n){t.setText(n),setImmediate(function(){t.onCommit()},0)},appendChild:function(t,e){t.appendChild(e)},appendChildToContainer:function(t,e){t.appendChild(e)},insertBefore:function(t,e,n){},insertInContainerBefore:function(t,e,n){t.insertBefore(e,n)},removeChild:function(t,e){t.removeChild(e)},removeChildFromContainer:function(t,e){t.removeChild(e)}}),y={render:function(t,e){var n=m.createContainer(e,!1,!1);return m.updateContainer(t,n,null,null),e}},I={default:y};module.exports=function(){return{components:I,container:r,SlackDom:y}};
//# sourceMappingURL=slack-renderer.js.map
